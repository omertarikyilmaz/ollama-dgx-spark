<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medya Takip Merkezi - AI Hub</title>
    <link rel="stylesheet" href="index.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="app-container">
        <!-- Global Header -->
        <header>
            <div class="brand" onclick="navigateTo('home')">
                <div class="brand-logo">âš¡</div>
                <div class="brand-title">
                    <div style="display: flex; flex-direction: column;">
                        <h1 style="line-height: 1;">MÄ°NNAL AI ADMÄ°N</h1>
                        <span
                            style="font-size: 0.75rem; color: var(--accent-blue); font-weight: 600; text-transform: uppercase; letter-spacing: 0.1em; margin-top: 2px;">MEDYA
                            TAKÄ°P MERKEZÄ°</span>
                    </div>
                </div>
            </div>
            <div class="system-status">
                <span id="ollama-status-dot" class="status-dot"></span>
                <span id="ollama-status-text">BaÄŸlanÄ±yor...</span>
            </div>
        </header>

        <!-- 1. Landing Page View -->
        <main id="view-home" class="service-view active hub-landing">
            <div class="hub-intro">
                <h2>HoÅŸ Geldiniz</h2>
                <p>GÃ¼Ã§lÃ¼ dil modelleri ile optimize edilmiÅŸ MTM yapay zeka servislerini keÅŸfedin.</p>
            </div>

            <div class="service-grid">
                <!-- AI Sohbet -->
                <div class="service-card" onclick="navigateTo('chat')">
                    <div class="service-icon" style="color: var(--accent-blue);"><i class="fas fa-comments"></i></div>
                    <h3>AI Sohbet</h3>
                    <p>Kurulu dil modeli ile doÄŸrudan mesajlaÅŸÄ±n, sorular sorun ve analiz yaptÄ±rÄ±n.</p>
                </div>

                <!-- Dil Tespit -->
                <div class="service-card" onclick="navigateTo('language')">
                    <div class="service-icon" style="color: var(--accent-purple);"><i class="fas fa-globe"></i></div>
                    <h3>Dil Tespit</h3>
                    <p>YÃ¼klenen metnin hangi dilde yazÄ±ldÄ±ÄŸÄ±nÄ± AI desteÄŸi ile saniyeler iÃ§inde tespit edin.</p>
                </div>

                <!-- SektÃ¶r SÄ±nÄ±flandÄ±rma -->
                <div class="service-card" onclick="navigateTo('sector')">
                    <div class="service-icon" style="color: var(--accent-pink);"><i class="fas fa-chart-pie"></i></div>
                    <h3>SektÃ¶r SÄ±nÄ±flandÄ±rma</h3>
                    <p>Haberleri teknoloji, finans, saÄŸlÄ±k gibi ana sektÃ¶rlere otomatik olarak ayÄ±rÄ±n.</p>
                </div>

                <!-- Haber SÄ±nÄ±flandÄ±rma -->
                <div class="service-card" onclick="navigateTo('news')">
                    <div class="service-icon" style="color: var(--accent-cyan);"><i class="fas fa-newspaper"></i></div>
                    <h3>Åirket SÄ±nÄ±flandÄ±rma</h3>
                    <p>Haberleri Ã¶zel ÅŸablonlara gÃ¶re ÅŸirket ve faaliyet alanÄ± bazlÄ± detaylÄ± sÄ±nÄ±flandÄ±rÄ±n.</p>
                </div>

                <!-- Rapor OluÅŸturucu -->
                <div class="service-card" onclick="navigateTo('report')">
                    <div class="service-icon" style="color: #22c55e;"><i class="fas fa-file-excel"></i></div>
                    <h3>Rapor OluÅŸturucu</h3>
                    <p>Birden fazla Excel dosyasÄ±nÄ± birleÅŸtirip yÃ¶netici Ã¶zeti ve grafikler iÃ§eren raporlar hazÄ±rlayÄ±n.
                    </p>
                </div>
            </div>
        </main>

        <!-- 2. Chat View -->
        <div id="view-chat" class="service-view">
            <div class="view-header">
                <button class="back-btn" onclick="navigateTo('home')"><i class="fas fa-arrow-left"></i> Geri</button>
                <div class="view-title">
                    <h2>ğŸ’¬ AI Sohbet</h2>
                    <p>Oturum bazlÄ± geliÅŸmiÅŸ asistan deneyimi</p>
                </div>
            </div>

            <div class="chat-wrapper">
                <!-- Chat Sidebar -->
                <aside class="chat-sidebar">
                    <button class="new-chat-btn" onclick="window.createNewChatSession()">
                        <i class="fas fa-plus"></i> Yeni Sohbet
                    </button>
                    <div class="chat-history-list" id="chat-session-list">
                        <!-- Sessions will be listed here -->
                    </div>
                </aside>

                <!-- Chat Main -->
                <div class="chat-container">
                    <div id="chat-messages" class="chat-messages">
                        <div class="chat-welcome" id="chat-welcome-screen">
                            <div class="welcome-icon">âš¡</div>
                            <h3>MÄ°NNAL AI</h3>
                            <p>Size nasÄ±l yardÄ±mcÄ± olabilirim?</p>
                        </div>
                    </div>
                    <div class="chat-input-area">
                        <input type="text" id="chat-input" class="chat-input" placeholder="Bir mesaj yazÄ±n..."
                            autocomplete="off">
                        <button id="chat-send-btn" class="send-btn"><i class="fas fa-paper-plane"></i></button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 3. Language View -->
        <div id="view-language" class="service-view">
            <div class="view-header">
                <button class="back-btn" onclick="navigateTo('home')"><i class="fas fa-arrow-left"></i> Geri</button>
                <div class="view-title">
                    <h2>ğŸŒ Dil Tespit Servisi</h2>
                    <p>Metin dilini AI analizi ile belirleyin</p>
                </div>
            </div>

            <div class="analysis-layout">
                <div class="analysis-input-panel">
                    <textarea id="lang-text-input" placeholder="Analiz edilecek metni buraya yapÄ±ÅŸtÄ±rÄ±n..."></textarea>
                    <button id="lang-detect-btn" class="btn btn-primary btn-large" style="width: 100%;">
                        <i class="fas fa-search"></i> Dili Tespit Et
                    </button>
                </div>
                <div class="analysis-result-panel" id="lang-result-panel">
                    <div class="result-placeholder">
                        <i class="fas fa-language"></i>
                        <p>HenÃ¼z analiz yapÄ±lmadÄ±.<br>Sol tarafa metin girerek baÅŸlayÄ±n.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 4. Sector View -->
        <div id="view-sector" class="service-view">
            <div class="view-header">
                <button class="back-btn" onclick="navigateTo('home')"><i class="fas fa-arrow-left"></i> Geri</button>
                <div class="view-title">
                    <h2>ğŸ“Š SektÃ¶r SÄ±nÄ±flandÄ±rma</h2>
                    <p>Haber metinlerini kategorilere ayÄ±rÄ±n</p>
                </div>
            </div>

            <div class="analysis-layout">
                <div class="analysis-input-panel">
                    <textarea id="sector-text-input"
                        placeholder="SÄ±nÄ±flandÄ±rÄ±lacak haberi buraya yapÄ±ÅŸtÄ±rÄ±n..."></textarea>
                    <button id="sector-classify-btn" class="btn btn-primary btn-large" style="width: 100%;">
                        <i class="fas fa-layer-group"></i> SektÃ¶rÃ¼ Belirle
                    </button>
                </div>
                <div class="analysis-result-panel" id="sector-result-panel">
                    <div class="result-placeholder">
                        <i class="fas fa-tags"></i>
                        <p>HenÃ¼z analiz yapÄ±lmadÄ±.<br>Haber metni girerek baÅŸlayÄ±n.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 5. Report Generator View -->
        <div id="view-report" class="service-view">
            <div class="view-header">
                <button class="back-btn" onclick="navigateTo('home')"><i class="fas fa-arrow-left"></i> Geri</button>
                <div class="view-title">
                    <h2>ğŸ“Š Rapor OluÅŸturucu</h2>
                    <p>Excel dosyalarÄ±nÄ± birleÅŸtirin ve Ã¶zet analiz raporu oluÅŸturun</p>
                </div>
            </div>

            <div class="report-container">
                <!-- LEFT SIDEBAR: ALL CONTROLS -->
                <div class="report-sidebar">
                    <!-- 1. Upload & Files -->
                    <div class="sidebar-section">
                        <h4 class="sidebar-heading"><i class="fas fa-file-import"></i> Dosyalar</h4>
                        <div class="upload-zone compact" id="report-upload-zone">
                            <i class="fas fa-plus-circle"></i>
                            <p>Dosya Ekle</p>
                            <input type="file" id="report-file-input" multiple accept=".xlsx, .xls" hidden>
                            <button class="overlay-btn"
                                onclick="document.getElementById('report-file-input').click()"></button>
                        </div>
                        <div id="selected-files-list" class="selected-files-list compact">
                            <!-- Files go here -->
                        </div>
                    </div>

                    <!-- 2. Layout Selector -->
                    <div id="layout-control-panel" class="sidebar-section" style="display: none;">
                        <h4 class="sidebar-heading"><i class="fas fa-paint-brush"></i> Tablo Tipi</h4>
                        <div class="layout-selector-vertical">
                            <div class="layout-option active" id="layout-standard"
                                onclick="window.selectReportLayout('standard')">
                                <span class="dot standard"></span>
                                <span class="label">Standart (YeÅŸil)</span>
                            </div>
                            <div class="layout-option" id="layout-modern" onclick="window.selectReportLayout('modern')">
                                <span class="dot modern"></span>
                                <span class="label">Modern (Mavi)</span>
                            </div>
                        </div>
                    </div>

                    <!-- 3. Actions -->
                    <div id="report-actions-panel" class="sidebar-section" style="display: none; margin-top: auto;">
                        <button id="preview-report-btn" class="btn btn-primary btn-block">
                            <i class="fas fa-play"></i> Ã–nizle
                        </button>
                        <!-- Download appears after preview -->
                        <div id="download-section"
                            style="display: none; border-top: 1px solid var(--border); padding-top: 1rem;">
                            <p
                                style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.5rem; text-align: center;">
                                Ã–nizleme onaylandÄ±ysa:</p>
                            <button id="download-report-btn" class="btn btn-success btn-block"
                                onclick="window.downloadFinalReport()">
                                <i class="fas fa-download"></i> Ä°NDÄ°R
                            </button>
                            <button class="btn btn-text btn-block btn-sm" onclick="window.resetReportView()">
                                <i class="fas fa-undo"></i> SÄ±fÄ±rla
                            </button>
                        </div>
                    </div>
                </div>

                <!-- RIGHT PANEL: PREVIEW ONLY -->
                <div class="report-preview-panel">
                    <div id="report-placeholder" class="report-placeholder">
                        <i class="fas fa-arrow-left" style="font-size: 2rem;"></i>
                        <p>Soldan dosya ekleyip Ã¶nizleme yapÄ±n.</p>
                    </div>

                    <div id="report-preview-content" class="report-preview-content" style="display: none;">
                        <div class="preview-box">
                            <div class="box-header">
                                <h5>Rapor Ã–zeti</h5>
                            </div>
                            <!-- Ultra Compact Table -->
                            <div class="table-responsive">
                                <table id="preview-summary-table" class="table-mini">
                                    <thead>
                                        <tr>
                                            <th>Mecra</th>
                                            <th class="text-right">Haber</th>
                                            <th class="text-right">EriÅŸim</th>
                                            <th class="text-right">R.EÅŸdeÄŸeri</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                    <tfoot></tfoot>
                                </table>
                            </div>
                        </div>

                        <div class="preview-box">
                            <div class="box-header">
                                <h5>Grafikler</h5>
                            </div>
                            <div class="charts-mini-grid">
                                <div class="mini-chart"><canvas id="chart-haber"></canvas></div>
                                <div class="mini-chart"><canvas id="chart-reklam"></canvas></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 6. News (Templates) View - Legacy compatible -->
        <div id="view-news" class="service-view">
            <div class="view-header">
                <button class="back-btn" onclick="navigateTo('home')"><i class="fas fa-arrow-left"></i> Geri</button>
                <div class="view-title">
                    <h2>ğŸ“° Åirket BazlÄ± SÄ±nÄ±flandÄ±rma</h2>
                    <p>Ã–zel ÅŸablonlar ile KV Cache destekli hÄ±zlÄ± analiz</p>
                </div>
            </div>

            <div class="news-layout">
                <!-- Templates Section -->
                <aside class="panel">
                    <div class="panel-title">Åablonlar</div>
                    <button id="new-template-btn" class="btn btn-secondary" style="margin-bottom: 1rem; width: 100%;">+
                        Yeni Åablon</button>
                    <div id="templates-list" class="templates-list">
                        <!-- Templates will be loaded here -->
                    </div>
                </aside>

                <!-- Classification Section -->
                <section class="panel" style="gap: 1.5rem;">
                    <div class="panel-title">Haber Analizi</div>
                    <div id="selected-template-badge" class="chip"
                        style="display: none; background: rgba(59, 130, 246, 0.2); color: var(--accent-blue); align-self: flex-start;">
                        SeÃ§ili Åablon: <span id="selected-template-name">...</span>
                    </div>
                    <textarea id="news-input"
                        style="flex: 1; min-height: 200px; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: var(--radius-md); padding: 1.5rem; color: #fff; font-family: inherit; resize: none;"
                        placeholder="Haberi buraya yapÄ±ÅŸtÄ±rÄ±n..."></textarea>
                    <div style="display: flex; gap: 1rem;">
                        <button id="classify-btn" class="btn btn-primary btn-large" style="flex: 1;" disabled>ğŸš€
                            SÄ±nÄ±flandÄ±r</button>
                        <button id="clear-btn" class="btn btn-secondary">Temizle</button>
                    </div>
                    <div id="news-result-content"
                        style="min-height: 150px; background: var(--bg-secondary); border-radius: var(--radius-md); padding: 1.5rem; border: 1px solid var(--border);">
                        <div class="result-placeholder">SonuÃ§ burada gÃ¶rÃ¼necek...</div>
                    </div>
                </section>

                <!-- Settings/Editor Section -->
                <aside class="panel">
                    <div class="panel-title">Ayarlar & EditÃ¶r</div>
                    <div class="panel-tabs" style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                        <button class="tab-btn active" onclick="switchNewsTab('settings')">âš™ï¸</button>
                        <button class="tab-btn" onclick="switchNewsTab('editor')">âœï¸</button>
                    </div>

                    <div id="settings-tab" class="news-tab-content active">
                        <!-- Standard Settings -->
                        <div class="form-group" style="margin-bottom: 1rem;">
                            <label>KV Cache Type</label>
                            <select id="kv-cache-type"
                                style="width: 100%; border-radius: 8px; background: var(--bg-tertiary); color: #fff; padding: 0.5rem;">
                                <option value="q4_0">Q4_0 (HÄ±zlÄ±)</option>
                                <option value="q8_0" selected>Q8_0 (Dengeli)</option>
                                <option value="f16">F16 (Kaliteli)</option>
                            </select>
                        </div>
                        <button id="save-settings-btn" class="btn btn-primary" style="width: 100%;">AyarlarÄ±
                            Kaydet</button>
                    </div>

                    <div id="editor-tab" class="news-tab-content" style="display: none;">
                        <div id="template-editor-form">
                            <!-- Template editor fields... -->
                            <p style="font-size: 0.75rem; color: var(--text-muted); text-align: center;">Åablon
                                dÃ¼zenlemek iÃ§in bir ÅŸablon seÃ§in or 'Yeni' butonuna basÄ±n.</p>
                        </div>
                    </div>
                </aside>
            </div>
        </div>

        <!-- Toast Notifications -->
        <div id="toast-container" class="toast-container"></div>

        <script src="app.js"></script>
</body>

</html>